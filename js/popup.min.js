"use strict";function sendClose(e){const t=$("#media-insert-form").get(0);if(null==t)return;const a=window.opener.the_toolbar,{data:l}=a.elements.extmedia;l.alignment=$('input[name="alignment"]:checked',t).val(),l.title=t.m_title.value,l.url=t.m_url.value,l.m_object=e,a.elements.extmedia.fncall[a.mode].call(a),window.close()}$((()=>{Object.assign(dotclear,dotclear.getData("external_media")),$("#media-insert-cancel").on("click",(()=>{window.close()})),$("#media-insert-ok").on("click",(()=>{const e=$("#media-insert-form").get(0).m_url.value;null==dotclear.external_media.api_key||""==dotclear.external_media.api_key?window.alert(dotclear.external_media.missing_key):$.getJSON(`https://api.embed.ly/1/oembed?url=${e}&key=${dotclear.external_media.api_key}&callback=?`,(e=>{sendClose(e.html)})).fail((e=>{window.alert(`${dotclear.external_media.request_error+e.status} ${e.statusText}`)}))}))}));
